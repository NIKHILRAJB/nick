<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Be My Valentine? üíï</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            cursor: none;
            padding: 10px;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><radialGradient id="a" cx="50%" cy="50%"><stop offset="0%" stop-color="%23ff6b9d"/><stop offset="100%" stop-color="rgba(255,107,157,0)"/></radialGradient></defs><circle cx="20" cy="20" r="2" fill="url(%23a)"><animate attributeName="cy" values="20;80;20" dur="3s" repeatCount="indefinite"/></circle><circle cx="80" cy="80" r="2" fill="url(%23a)"><animate attributeName="cy" values="80;20;80" dur="3s" repeatCount="indefinite"/></circle><circle cx="40" cy="60" r="2" fill="url(%23a)"><animate attributeName="cy" values="60;10;60" dur="2.5s" repeatCount="indefinite"/></circle></svg>') repeat;
            animation: sparkle 2s infinite linear;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Intro Screen */
        .intro-screen {
            text-align: center;
            z-index: 100;
            position: relative;
            width: 100%;
            max-width: 400px;
        }

        .intro-title {
            font-size: clamp(2em, 8vw, 3.5em);
            color: #e91e63;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: titlePulse 2s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .big-heart {
            font-size: clamp(10em, 30vw, 15em);
            cursor: pointer;
            animation: heartbeat 1.5s ease-in-out infinite;
            transition: all 0.3s ease;
            margin: 15px 0;
            filter: drop-shadow(0 0 20px rgba(233, 30, 99, 0.5));
            touch-action: manipulation;
        }

        .big-heart:hover, .big-heart:active {
            transform: scale(1.1);
            filter: drop-shadow(0 0 30px rgba(233, 30, 99, 0.8));
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            14% { transform: scale(1.1); }
            28% { transform: scale(1); }
            42% { transform: scale(1.1); }
            70% { transform: scale(1); }
        }

        .intro-text {
            font-size: clamp(1.2em, 4vw, 1.8em);
            color: #333;
            margin-top: 15px;
            animation: fadeInUp 2s ease-out 1s both;
        }

        /* Hide cursor on mobile */
        @media (hover: none) and (pointer: coarse) {
            body { cursor: default; }
            .cursor { display: none !important; }
        }

        .cursor {
            position: fixed;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, #ff6b9d, transparent);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transition: transform 0.1s ease;
            mix-blend-mode: difference;
        }

        /* Quiz Container */
        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: clamp(20px, 5vw, 40px);
            max-width: 95vw;
            width: 100%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            position: relative;
            z-index: 10;
            margin: 10px;
        }

        h1 {
            font-size: clamp(1.8em, 6vw, 2.2em);
            color: #e91e63;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        /* Question Boxes */
        .question-box {
            background: linear-gradient(135deg, #fff3e0, #fff8e1);
            border-radius: 20px;
            padding: clamp(20px, 6vw, 35px) clamp(15px, 4vw, 25px);
            margin: 15px 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 3px solid rgba(233, 30, 99, 0.2);
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .question-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .question-box.active::before {
            left: 100%;
        }

        .question-text {
            font-size: clamp(1.2em, 5vw, 1.5em);
            color: #e91e63;
            margin-bottom: 20px;
            font-weight: bold;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* SPECIAL IMAGE FOR QUESTION 4 */
        .question-image {
            width: 100%;
            max-width: 300px;
            max-height: 200px;
            height: auto;
            object-fit: cover;
            border-radius: 15px;
            margin: 15px auto;
            display: block;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            border: 4px solid rgba(233, 30, 99, 0.4);
            pointer-events: none;
        }

        @media (max-width: 480px) {
            .question-image {
                max-width: 250px;
                max-height: 180px;
            }
        }

        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(8px, 3vw, 15px);
            position: relative;
            z-index: 10;
        }

        .option {
            background: linear-gradient(145deg, #ff9a9e, #fecfef);
            border: none;
            padding: clamp(12px, 4vw, 18px);
            border-radius: 15px;
            font-size: clamp(1em, 4vw, 1.1em);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(233, 30, 99, 0.3);
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }

        .option:hover:not(.correct):not(.wrong), .option:active:not(.correct):not(.wrong) {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(233, 30, 99, 0.4);
        }

        .option.correct {
            background: linear-gradient(145deg, #4caf50, #81c784);
            animation: celebrate 0.6s ease;
        }

        .option.wrong {
            background: linear-gradient(145deg, #f44336, #ef5350);
            animation: shake 0.5s ease;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(145deg, #fff, #f8f9fa);
            padding: clamp(25px, 8vw, 40px);
            border-radius: 20px;
            text-align: center;
            max-width: 90vw;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transform: scale(0.7);
            transition: transform 0.3s ease;
            border: 3px solid rgba(233, 30, 99, 0.3);
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal-emoji {
            font-size: clamp(3em, 10vw, 5em);
            margin-bottom: 20px;
        }

        .modal-message {
            font-size: clamp(1.1em, 4vw, 1.4em);
            color: #333;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .next-btn {
            background: linear-gradient(145deg, #e91e63, #ad1457);
            color: white;
            border: none;
            padding: clamp(12px, 4vw, 15px) clamp(25px, 6vw, 40px);
            border-radius: 50px;
            font-size: clamp(1em, 4vw, 1.2em);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(233, 30, 99, 0.4);
            touch-action: manipulation;
        }

        .next-btn:hover, .next-btn:active {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(233, 30, 99, 0.5);
        }

        /* Final Question */
        .final-question {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: clamp(25px, 8vw, 40px);
            border-radius: 20px;
            margin-top: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            position: relative;
        }

        .button-zone {
            position: relative;
            width: 95%;
            max-width: 400px;
            height: clamp(120px, 35vw, 150px);
            margin: 20px auto 0;
            touch-action: none;
        }

        .yes-btn, .no-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            padding: clamp(12px, 4vw, 16px) clamp(20px, 6vw, 32px);
            font-size: clamp(16px, 5vw, 20px);
            font-weight: 800;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            box-shadow: 0 10px 24px rgba(0,0,0,.14);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            transition: all .12s ease;
            min-height: 50px;
        }

        #yesBtn {
            left: 10%;
            background: linear-gradient(145deg, #4caf50, #66bb6a);
            color: #fff;
        }

        #yesBtn:hover, #yesBtn:active { 
            background: linear-gradient(145deg, #45a049, #5cb85c);
            transform: translateY(-50%) scale(1.05);
        }

        #noBtn {
            right: 10%;
            background: #e5e7eb;
            color: #111827;
        }

        /* Celebration Page */
        .celebration-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(-45deg, #ff6b6b, #4ecdc4, #45b7d1, #f9ca24, #f0932b, #eb4d4b);
            background-size: 400% 400%;
            animation: gradientShift 4s ease infinite;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease;
            padding: 20px;
        }

        .celebration-page.show {
            opacity: 1;
            visibility: visible;
        }

        .mega-heart {
            font-size: clamp(8em, 25vw, 12em);
            animation: megaHeartbeat 1.2s ease-in-out infinite;
            filter: drop-shadow(0 0 40px rgba(255,255,255,0.8));
            margin-bottom: 20px;
        }

        @keyframes megaHeartbeat {
            0%, 100% { transform: scale(1) rotate(-2deg); }
            50% { transform: scale(1.15) rotate(2deg); }
        }

        .love-message {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(20px);
            padding: clamp(25px, 8vw, 40px) clamp(20px, 6vw, 30px);
            border-radius: 25px;
            border: 2px solid rgba(255,255,255,0.3);
            max-width: 95vw;
            max-height: 50vh;
            overflow-y: auto;
            text-align: center;
            color: white;
            font-size: clamp(1.1em, 4vw, 1.4em);
            line-height: 1.6;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            animation: floatIn 1s ease-out 0.5s both;
        }

        .signature {
            margin-top: 20px;
            font-size: clamp(1.4em, 5vw, 1.8em);
            color: rgba(255,255,255,0.9);
            font-weight: bold;
            animation: fadeInUp 1s ease-out 1.5s both;
        }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes floatIn {
            from { opacity: 0; transform: translateY(50px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        .hearts, .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        .heart, .floating-heart {
            position: absolute;
            font-size: clamp(12px, 3vw, 20px);
            color: #ff4081;
            animation: float 3s ease-out forwards;
        }

        .hidden { display: none !important; }
        body.intro .cursor { display: none; }
    </style>
</head>
<body class="intro">
    <!-- Custom Cursor -->
    <div class="cursor" id="cursor"></div>
    
    <!-- Intro Screen -->
    <div class="intro-screen" id="introScreen">
        <div class="intro-title">üíï My Love üíï</div>
        <div class="big-heart" id="startHeart">üíñ</div>
        <div class="intro-text">Click the heart to begin our special journey... ‚ú®</div>
    </div>

    <!-- Quiz Screen -->
    <div class="hearts" id="hearts"></div>
    <div class="container hidden" id="quizContainer">
        <h1 id="quizTitle">üíï Will You... üíï</h1>
        
        <!-- Question 1 -->
        <div class="question-box active" id="questionBox1">
            <div class="question-text" id="q1">When is my birthday? üéÇ</div>
            <div class="options" id="options1">
                <button class="option" data-correct="false">Feb 2</button>
                <button class="option" data-correct="false">March 22</button>
                <button class="option" data-correct="true">Sept 9</button>
                <button class="option" data-correct="false">July 4</button>
            </div>
        </div>

        <!-- Question 2 -->
        <div class="question-box hidden" id="questionBox2">
            <div class="question-text" id="q2">Where did we first meet? ‚ú®</div>
            <div class="options" id="options2">
                <button class="option" data-correct="false">Kochi</button>
                <button class="option" data-correct="true">Kolkata</button>
                <button class="option" data-correct="false">Info Park</button>
                <button class="option" data-correct="false">LULU Mall</button>
            </div>
        </div>

        <!-- Question 3 -->
        <div class="question-box hidden" id="questionBox3">
            <div class="question-text" id="q3">Where was our first date? üåπ</div>
            <div class="options" id="options3">
                <button class="option" data-correct="false">Office</button>
                <button class="option" data-correct="false">Beach</button>
                <button class="option" data-correct="true">Caravan Cafe</button>
                <button class="option" data-correct="false">Barbie Movie</button>
            </div>
        </div>

        <!-- Question 4 - WITH IMAGE -->
        <div class="question-box hidden" id="questionBox4">
            <div class="question-text" id="q4">Where did we click this photo? üì∏</div>
            <img src="abcde.jpg" alt="Our Kochi memory üíï" class="question-image" onerror="this.style.display='none';">
            <div class="options" id="options4">
                <button class="option" data-correct="false">Home</button>
                <button class="option" data-correct="true">Kochi</button>
                <button class="option" data-correct="false">Kolkata</button>
                <button class="option" data-correct="false">Street</button>
            </div>
        </div>

        <!-- Final Question -->
        <div class="final-question hidden" id="finalQ">
            <div class="question-text" style="color: white; font-size: clamp(1.4em, 6vw, 1.8em); margin-bottom: 20px;">
                Will you be my Valentine? üíù
            </div>
            <div class="button-zone" id="buttonZone">
                <button id="yesBtn" class="yes-btn">Yes üíï</button>
                <button id="noBtn" class="no-btn">No üò¢</button>
            </div>
        </div>
    </div>

    <!-- Wrong Answer Modal -->
    <div class="modal hidden" id="wrongModal">
        <div class="modal-content">
            <div class="modal-emoji" id="modalEmoji">üò¢</div>
            <div class="modal-message" id="modalMessage"></div>
            <button class="next-btn" id="nextBtnModal">Continue üíñ</button>
        </div>
    </div>

    <!-- Celebration Page -->
    <div class="celebration-page" id="celebrationPage">
        <div class="floating-hearts" id="floatingHearts"></div>
        <div class="mega-heart">üíñ</div>
        <div class="love-message">
            <span style="font-size: 2.5em; font-weight: bold; color: #e91e63; display: block; margin-bottom: 10px;">To my Nami üíï</span><br>
            From the moment I met you, my world changed forever. üåü<br><br>
            Every laugh, every smile, every moment with you feels like a dream I never want to wake from. 
            You are my sunshine on cloudy days, my strength when I'm weak, and my heart when it beats. üíì<br><br>
            Saying "Yes" made me the happiest person alive. I promise to love you, cherish you, 
            and make every day special - today, tomorrow, and always. üíç‚ú®<br><br>
            <span style="font-size: 1.3em; font-weight: bold;">You are my forever Valentine üíï</span>
        </div>
        <div class="signature">Forever Yours üíñ</div>
    </div>

    <script>
        const questionsData = {
            1: { wrongMsg: "Aww... close but not quite! Think of that special September day! üåå", correctMsg: "Yay! Sept 9th - you remember my special day! üíì" },
            2: { wrongMsg: "Hmm... not there! Think about where our eyes first met in Kolkata! ‚ú®", correctMsg: "Perfect! Kolkata - where our love story began! üíò" },
            3: { wrongMsg: "Not quite! Remember our magical first date at Caravan Cafe! ‚≠ê", correctMsg: "Yes! Caravan Cafe - the start of our beautiful love story! üåπ" },
            4: { wrongMsg: "Try again! Look at that beautiful photo - where was that moment? üì∏", correctMsg: "Exactly! Kochi - that moment captured our love perfectly! üòç" }
        };

        let currentQuestion = 1;
        let yesScale = 1;
        let zone = null;
        let noBtn = null;
        let yesBtn = null;
        let isQuizStarted = false;
        let isProcessing = false;
        let questionTimeouts = [];

        // Clear all pending timeouts
        function clearAllTimeouts() {
            questionTimeouts.forEach(timeoutId => clearTimeout(timeoutId));
            questionTimeouts = [];
        }

        // Custom cursor
        document.addEventListener('mousemove', (e) => {
            if (isQuizStarted) {
                const cursor = document.getElementById('cursor');
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            }
        });

        // SINGLE EVENT DELEGATION FOR ALL CLICKS
        document.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Start quiz
            if (e.target.id === 'startHeart' && !isQuizStarted) {
                startQuiz();
                return;
            }
            
            // Skip if processing
            if (isProcessing || !isQuizStarted) return;
            
            // Quiz option buttons
            const optionBtn = e.target.closest('.option');
            if (optionBtn && !optionBtn.classList.contains('correct') && !optionBtn.classList.contains('wrong')) {
                const questionNum = parseInt(optionBtn.closest('[id^="questionBox"]').id.replace('questionBox', ''));
                handleOptionClick(questionNum, optionBtn);
                return;
            }
            
            // Modal next button
            if (e.target.id === 'nextBtnModal') {
                nextQuestionAuto();
                return;
            }
            
            // Yes button
            if (e.target.id === 'yesBtn') {
                celebrate();
                return;
            }
        });

        function startQuiz() {
            document.getElementById('introScreen').classList.add('hidden');
            document.body.classList.remove('intro');
            document.getElementById('quizContainer').classList.remove('hidden');
            isQuizStarted = true;
        }

        function handleOptionClick(questionNum, btn) {
            if (isProcessing) return;
            
            isProcessing = true;
            clearAllTimeouts();
            
            const isCorrect = btn.dataset.correct === 'true';
            const options = document.querySelectorAll(`#options${questionNum} .option`);
            
            options.forEach(opt => opt.style.pointerEvents = 'none');

            if (isCorrect) {
                btn.classList.add('correct');
                showCelebration(questionNum);
            } else {
                btn.classList.add('wrong');
                options.forEach(opt => {
                    if (opt.dataset.correct === 'true') opt.classList.add('correct');
                });
                showWrongModal(questionNum);
            }
        }

        function showWrongModal(questionNum) {
            const modal = document.getElementById('wrongModal');
            document.getElementById('modalEmoji').textContent = 'üò¢üíî';
            document.getElementById('modalMessage').textContent = questionsData[questionNum].wrongMsg;
            modal.classList.remove('hidden');
            modal.classList.add('show');
            
            const timeout = questionNum === 4 ? 4000 : 3000;
            questionTimeouts.push(setTimeout(() => {
                nextQuestionAuto();
                isProcessing = false;
            }, timeout));
        }

        function showCelebration(questionNum) {
            const celebrationDiv = document.createElement('div');
            celebrationDiv.id = 'celebrationPopup';
            celebrationDiv.innerHTML = `<div style="font-size:4em;margin-bottom:10px;">üéâ‚ú®</div><div style="font-size:1.3em;">${questionsData[questionNum].correctMsg}</div>`;
            celebrationDiv.style.cssText = `
                position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                background: linear-gradient(135deg, rgba(76,175,80,0.95), rgba(129,199,132,0.95));
                color: white; padding: 35px; border-radius: 25px; text-align: center;
                z-index: 1500; box-shadow: 0 20px 50px rgba(76,175,80,0.4);
                border: 3px solid rgba(255,255,255,0.3); opacity: 0; font-weight: bold;
            `;
            document.body.appendChild(celebrationDiv);
            
            setTimeout(() => {
                if (celebrationDiv.parentNode) {
                    celebrationDiv.style.opacity = '1';
                    celebrationDiv.style.transform = 'translate(-50%, -50%) scale(1)';
                }
            }, 100);
            
            const timeout = questionNum === 4 ? 3500 : 2500;
            questionTimeouts.push(setTimeout(() => {
                nextQuestionAuto();
                if (celebrationDiv.parentNode) celebrationDiv.remove();
                isProcessing = false;
            }, timeout));
        }

        function nextQuestionAuto() {
            clearAllTimeouts();
            
            const modal = document.getElementById('wrongModal');
            if (!modal.classList.contains('hidden')) {
                modal.classList.remove('show');
                modal.classList.add('hidden');
            }
            
            const currentBox = document.getElementById(`questionBox${currentQuestion}`);
            if (currentBox) {
                currentBox.classList.remove('active');
                currentBox.classList.add('hidden');
            }
            
            document.querySelectorAll(`#options${currentQuestion} .option`).forEach(opt => {
                opt.classList.remove('correct', 'wrong');
                opt.style.pointerEvents = 'auto';
            });
            
            if (currentQuestion < 4) {
                currentQuestion++;
                const nextBox = document.getElementById(`questionBox${currentQuestion}`);
                if (nextBox) {
                    nextBox.classList.remove('hidden');
                    questionTimeouts.push(setTimeout(() => {
                        nextBox.classList.add('active');
                    }, 200));
                }
            } else {
                questionTimeouts.push(setTimeout(() => {
                    showFinalQuestion();
                    isProcessing = false;
                }, 500));
            }
        }

        function showFinalQuestion() {
            document.getElementById('finalQ').classList.remove('hidden');
            document.getElementById('quizTitle').textContent = 'Final Question üíñ';
            zone = document.getElementById('buttonZone');
            yesBtn = document.getElementById('yesBtn');
            noBtn = document.getElementById('noBtn');
        }

        function clamp(n, min, max) { 
            return Math.max(min, Math.min(max, n)); 
        }

        function moveNo(px, py) {
            if (!zone || !noBtn) return;
            
            const z = zone.getBoundingClientRect();
            const b = noBtn.getBoundingClientRect();
            let dx = (b.left + b.width / 2) - px;
            let dy = (b.top + b.height / 2) - py;
            let mag = Math.hypot(dx, dy) || 1;
            dx /= mag; dy /= mag;

            let newLeft = (b.left - z.left) + dx * 150;
            let newTop  = (b.top - z.top) + dy * 150;
            newLeft = clamp(newLeft, 0, z.width - b.width);
            newTop  = clamp(newTop, 0, z.height - b.height);

            noBtn.style.left = newLeft + "px";
            noBtn.style.top = newTop + "px";
            noBtn.style.transform = "none";
            
            yesScale = Math.min(2.2, yesScale + 0.1);
            if (yesBtn) yesBtn.style.transform = `translateY(-50%) scale(${yesScale})`;
        }

        function celebrate() {
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('celebrationPage').classList.add('show');
            createFloatingHearts();
            setInterval(createHeartRain, 300);
        }

        function createFloatingHearts() {
            const container = document.getElementById('floatingHearts');
            const hearts = ['üíñ', 'üíï', 'üíó', 'üíù', 'üíò', 'üåπ'];
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.className = 'floating-heart';
                    heart.innerHTML = hearts[Math.floor(Math.random() * hearts.length)];
                    heart.style.left = Math.random() * 100 + '%';
                    heart.style.animationDuration = (Math.random() * 3 + 3) + 's';
                    heart.style.animationDelay = Math.random() * 2 + 's';
                    container.appendChild(heart);
                    setTimeout(() => heart.remove(), 7000);
                }, i * 100);
            }
        }

        function createHeartRain() {
            const heart = document.createElement('div');
            heart.innerHTML = ['üíñ', 'üíï', 'üíó'][Math.floor(Math.random() * 3)];
            heart.style.cssText = `
                position: fixed; top: -20px; left: ${Math.random() * 100}%;
                font-size: ${Math.random() * 15 + 10}px; color: #ff4081;
                pointer-events: none; z-index: 4000; animation: float 4s linear forwards;
            `;
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 4000);
        }

        // Final question mouse movement (No Button Chase)
        document.addEventListener('pointermove', function(e) {
            if (zone && noBtn) {
                const b = noBtn.getBoundingClientRect();
                const d = Math.hypot(
                    (b.left + b.width / 2) - e.clientX,
                    (b.top + b.height / 2) - e.clientY
                );
                if (d < 140) {
                    moveNo(e.clientX, e.clientY);
                }
            }
        });

        // Prevent No button from being clicked
        document.addEventListener('click', function(e) {
            if (e.target.id === 'noBtn') {
                e.preventDefault();
                e.stopPropagation();
            }
        });
    </script>
</body>
</html>
